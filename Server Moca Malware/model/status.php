<?php
    if(!defined('__ROOT__'))
        define ('__ROOT__', $_SERVER['DOCUMENT_ROOT']);

    define ('__STATUS__', __ROOT__ . '/moca/data/status.json');

    if (!file_exists(__STATUS__))
        initializeStatus();

    // Current status object
    $status = json_decode(file_get_contents(__STATUS__), true);

    function getStatus()
    {
        global $status;
        return $status;
    }

    function setStatus($object)
    {
        file_put_contents(__STATUS__, json_encode($object, true));
    }

    function getAttribute ($attribute)
    {
        global $status;
        return $status[$attribute];
    }

    function setAttribute ($attribute, $value)
    {
        global $status;
        $status[$attribute] = $value;
        setStatus($status);
    }

    function initializeStatus()
    {
        $default_status = array (
              "installed" => null,
              "ip_address" => null,
              "computer_name" => null,
              "username" => null,
              "installation_path" => null,
              "autorun" => null,
              "running" => null,
              "error" => null
        );
        setStatus($default_status);
    }

?>